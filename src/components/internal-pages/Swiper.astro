---
import "swiper/css";
import "swiper/css/effect-cards";

import { Image } from "astro:assets";

import LeftArrow from "@assets/arrows/Left-arrow.astro";
import RightArrow from "@assets/arrows/Right-arrow.astro";

const { imagesArr } = Astro.props;
---

<script src="/src/scripts/swiperScript.ts"></script>

<div class="swiper-container-wrapper">
  <div class="swiper">
    <div class="swiper-wrapper">
      {
        [...imagesArr, ...imagesArr].map((image, index) => {
          const originalArrayLength = imagesArr.length * 2;

          const isEagerLoad = index < 2 || index === originalArrayLength - 1;

          return (
            <div class="swiper-slide">
              <Image
                class="swiper-slide-image"
                src={image.img}
                alt={image.imgAlt}
                loading={isEagerLoad ? "eager" : "lazy"}
              />
            </div>
          );
        })
      }
    </div>

    <div class="swiper-controls">
      <button
        class="swiper-prev"
        aria-label="BotÃ³ per moure les imagtges a l'esquerre del carrusel"
      >
        <LeftArrow />
      </button>
      <button class="swiper-next">
        <RightArrow />
      </button>
    </div>
  </div>
</div>

<style>
  .swiper-container-wrapper,
  .swiper,
  .swiper-wrapper,
  .swiper-slide {
    touch-action: pan-y pinch-zoom;
  }
  
  .swiper-container-wrapper {
    max-width: 100vw;
    padding-bottom: var(--space-y-page-section);
    background-color: var(--clr-secondary);
  }

  .swiper-slide {
    width: var(--slide-width);
    aspect-ratio: 593 / 343;
    height: 21.4375rem;
    overflow: hidden;
  }

  .swiper-controls {
    width: 100%;
    display: flex;
    justify-content: center;
    gap: 1.75rem;
    padding-top: 2.75rem;
  }

  .swiper-slide-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: bottom;
  }

  @media (width < 710px) {
    .swiper-slide {
      width: 85vw;
      height: auto;
      aspect-ratio: 593 / 343;
    }

    .swiper-slide-image {
      width: 100%;
      height: 100%;
    }
  }
</style>
